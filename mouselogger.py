import pythoncom, pyHook, ctypes, time, sys
from PIL import Image, ImageDraw

user32 = ctypes.windll.user32
screensize = user32.GetSystemMetrics(0), user32.GetSystemMetrics(1)
lastclick = (screensize[0]/2, screensize[1]/2)
end = time.time() + 60*2
im = Image.new('RGB',screensize, (255,255,255))

def OnMouseEvent(event):
    global lastclick, end, im
    if event.Message == 513:
        draw = ImageDraw.Draw(im)
        draw.line((lastclick, event.Position), fill=128, width=4)
        lastclick = event.Position
    if time.time() > end:
            im.save('out.jpg', 'JPEG', quality=80)
            sys.exit(0)
            return True